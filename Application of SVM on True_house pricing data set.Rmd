---
title: "problem 3, assignment2"
author: "B. Sudheer Kr Reddy"
date: "03/02/2022"
output: pdf_document
---

```{r message=FALSE, warning=FALSE, paged.print=FALSE}
library(dplyr)
library(ggplot2)
library(tidyverse)
library(readxl)
library(GGally)
library(car)
library(ggpubr)
library(ggrepel)
library(MASS)
library(readr)
library(e1071)
library(caret)
HousePriceData <- read_csv("C:/Users/BSK/Downloads/true_data.csv")
View(HousePriceData)
colnames(HousePriceData)
HousePriceData$POSTED_BY <- as.factor(HousePriceData$POSTED_BY)
HousePriceData$UNDER_CONSTRUCTION <- as.factor(HousePriceData$UNDER_CONSTRUCTION)
HousePriceData$RERA <- as.factor(HousePriceData$RERA)
HousePriceData$READY_TO_MOVE <- as.factor(HousePriceData$READY_TO_MOVE)
HousePriceData$RESALE <- as.factor(HousePriceData$RESALE)
HousePriceData$BHK_OR_RK <- as.factor(HousePriceData$BHK_OR_RK)
HousePriceData$ADDRESS <- as.factor(HousePriceData$ADDRESS)
train_HousePriceData <- HousePriceData %>% filter(TEST==0)
test_HousePriceData <- HousePriceData %>% filter(TEST==1)
Model0 <- lm(TARGET.PRICE_IN_LACS.~ POSTED_BY + UNDER_CONSTRUCTION + RERA + READY_TO_MOVE + RESALE + BHK_NO. + SQUARE_FT + LONGITUDE + LATITUDE, train_HousePriceData)
pred <- predict(Model0, test_HousePriceData)
view(pred)
MSE_Reg <- mean((pred - test_HousePriceData$TARGET.PRICE_IN_LACS.)^2)
MAE_Reg <- mean(abs(pred - test_HousePriceData$TARGET.PRICE_IN_LACS.))
MAPE_Reg <- mean(abs((pred - test_HousePriceData$TARGET.PRICE_IN_LACS.)/test_HousePriceData$TARGET.PRICE_IN_LACS.))
model1 <- svm(TARGET.PRICE_IN_LACS.~ POSTED_BY + UNDER_CONSTRUCTION + RERA + READY_TO_MOVE + RESALE + BHK_NO. + SQUARE_FT + LONGITUDE + LATITUDE, train_HousePriceData,kernel = "linear", scale = TRUE, nu = 0.1)
pred1 <- predict(model1, test_HousePriceData)
view(pred1)
MSE_Lin <- mean((pred1 - test_HousePriceData$TARGET.PRICE_IN_LACS.)^2)
MAE_Lin <- mean(abs(pred1 - test_HousePriceData$TARGET.PRICE_IN_LACS.))
MAPE_Lin <- mean(abs((pred1 - test_HousePriceData$TARGET.PRICE_IN_LACS.)/test_HousePriceData$TARGET.PRICE_IN_LACS.))
model2 <- svm(TARGET.PRICE_IN_LACS.~ POSTED_BY + UNDER_CONSTRUCTION + RERA + READY_TO_MOVE + RESALE + BHK_NO. + SQUARE_FT + LONGITUDE + LATITUDE, data = train_HousePriceData, kernel = "polynomial", scale = TRUE, nu = 0.1, degree = 1)
pred2 <- predict(model2, test_HousePriceData)
view(pred2)
MSE_Pol <- mean((pred2 - test_HousePriceData$TARGET.PRICE_IN_LACS.)^2)
MAE_Pol <- mean(abs(pred2 - test_HousePriceData$TARGET.PRICE_IN_LACS.))
MAPE_Pol <- mean(abs((pred2 - test_HousePriceData$TARGET.PRICE_IN_LACS.)/test_HousePriceData$TARGET.PRICE_IN_LACS.))
model3 <- svm(TARGET.PRICE_IN_LACS.~ POSTED_BY + UNDER_CONSTRUCTION + RERA + READY_TO_MOVE + RESALE + BHK_NO. + SQUARE_FT + LONGITUDE + LATITUDE, data = train_HousePriceData, kernel = "radial", scale = TRUE, nu = 0.1)
pred3 <- predict(model3, test_HousePriceData)
view(pred3)
MSE_Rad <- mean((pred3 - test_HousePriceData$TARGET.PRICE_IN_LACS.)^2)
MAE_Rad <- mean(abs(pred3 - test_HousePriceData$TARGET.PRICE_IN_LACS.))
MAPE_Rad <- mean(abs((pred3 - test_HousePriceData$TARGET.PRICE_IN_LACS.)/test_HousePriceData$TARGET.PRICE_IN_LACS.))
model4 <- svm(TARGET.PRICE_IN_LACS.~ POSTED_BY + UNDER_CONSTRUCTION + RERA + READY_TO_MOVE + RESALE + BHK_NO. + SQUARE_FT + LONGITUDE + LATITUDE, data = train_HousePriceData, kernel = "sigmoid", scale = TRUE, nu = 0.1)
pred4 <- predict(model4, test_HousePriceData)
MSE_Sig <- mean((pred4 - test_HousePriceData$TARGET.PRICE_IN_LACS.)^2)
MAE_Sig <- mean(abs(pred4 - test_HousePriceData$TARGET.PRICE_IN_LACS.))
MAPE_sig <- mean(abs((pred4 - test_HousePriceData$TARGET.PRICE_IN_LACS.)/test_HousePriceData$TARGET.PRICE_IN_LACS.))
```

